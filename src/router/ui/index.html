<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fraud PoC Router</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-slate-50 text-slate-900">
    <div class="max-w-6xl mx-auto p-6 space-y-6">
      <header class="flex items-center justify-between">
        <div>
          <h1 class="text-2xl font-semibold">Fraud PoC Router</h1>
          <p class="text-sm text-slate-500">Canary / Shadow routing gateway</p>
        </div>
        <div class="text-sm space-x-4">
          <a class="text-blue-600 hover:underline" href="/docs">/docs</a>
          <a class="text-blue-600 hover:underline" href="/metrics">/metrics</a>
        </div>
      </header>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <section class="bg-white rounded-lg shadow p-5 space-y-4">
          <div class="flex items-center justify-between">
            <h2 class="text-lg font-semibold">Score a Transaction</h2>
            <div class="flex items-center gap-2">
              <select id="driftPreset" class="text-sm border rounded px-2 py-1">
                <option value="normal">Normal</option>
                <option value="new_country">Drift: New Country</option>
                <option value="ato_spike">Drift: ATO Spike</option>
                <option value="merchant_campaign">Drift: Merchant Campaign</option>
              </select>
              <button id="randomBtn" class="text-sm px-3 py-1 rounded bg-slate-200 hover:bg-slate-300">
                Generate random example
              </button>
            </div>
          </div>
          <div class="grid grid-cols-2 gap-3 text-sm">
            <label class="space-y-1">
              <span>User ID</span>
              <input id="user_id" class="w-full border rounded px-2 py-1" type="number" />
            </label>
            <label class="space-y-1">
              <span>Merchant ID</span>
              <input id="merchant_id" class="w-full border rounded px-2 py-1" type="number" />
            </label>
            <label class="space-y-1">
              <span>Device ID</span>
              <input id="device_id" class="w-full border rounded px-2 py-1" type="number" />
            </label>
            <label class="space-y-1">
              <span>IP ID</span>
              <input id="ip_id" class="w-full border rounded px-2 py-1" type="number" />
            </label>
            <label class="space-y-1">
              <span>Amount</span>
              <input id="amount" class="w-full border rounded px-2 py-1" type="number" step="0.01" />
            </label>
            <label class="space-y-1">
              <span>Currency</span>
              <input id="currency" class="w-full border rounded px-2 py-1" type="text" value="USD" />
            </label>
            <label class="space-y-1">
              <span>Country</span>
              <input id="country" class="w-full border rounded px-2 py-1" type="text" value="US" />
            </label>
            <label class="space-y-1">
              <span>Channel</span>
              <select id="channel" class="w-full border rounded px-2 py-1">
                <option value="web">web</option>
                <option value="mobile">mobile</option>
              </select>
            </label>
            <label class="space-y-1">
              <span>Drift Phase</span>
              <input id="drift_phase" class="w-full border rounded px-2 py-1" type="number" value="0" />
            </label>
          </div>
          <button id="scoreBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded">
            Score
          </button>
          <p id="scoreError" class="text-sm text-red-600 hidden"></p>
        </section>

        <section class="bg-white rounded-lg shadow p-5 space-y-4">
          <h2 class="text-lg font-semibold">Latest Result</h2>
          <div class="flex items-center gap-3">
            <span id="decisionBadge" class="px-2 py-1 rounded text-sm bg-slate-200">n/a</span>
            <span class="text-sm text-slate-600">Final score: <span id="finalScore">-</span></span>
          </div>
          <div class="grid grid-cols-3 gap-3 text-sm">
            <div class="bg-slate-50 p-2 rounded">Rules: <span id="rulesScore">-</span></div>
            <div class="bg-slate-50 p-2 rounded">Champion: <span id="championScore">-</span></div>
            <div class="bg-slate-50 p-2 rounded">Anomaly: <span id="anomalyScore">-</span></div>
          </div>
          <div class="text-sm">
            <div class="text-slate-600 mb-1">Served By</div>
            <div class="text-xs text-slate-500">served_by: <span id="servedBy">-</span></div>
          </div>
          <div class="text-sm text-slate-600">
            Fallbacks: <span id="fallbacksList">none</span>
          </div>
          <div class="text-sm text-slate-600">
            Latency: <span id="latencyTotal">-</span> ms
          </div>
        </section>

        <section class="bg-white rounded-lg shadow p-5 space-y-3">
          <h2 class="text-lg font-semibold">Routing</h2>
          <div class="text-sm text-slate-600">Mode: <span id="routerMode">-</span></div>
          <div class="text-sm text-slate-600">Canary %: <span id="canaryPercent">-</span></div>
          <div class="text-sm text-slate-600">V1 ok: <span id="v1Ok">-</span></div>
          <div class="text-sm text-slate-600">V2 ok: <span id="v2Ok">-</span></div>
        </section>

        <section class="bg-white rounded-lg shadow p-5 space-y-3 lg:col-span-2">
          <div class="flex items-center justify-between">
            <h2 class="text-lg font-semibold">Shadow Comparisons</h2>
            <div class="text-xs text-slate-500">Polling every 2s</div>
          </div>
          <div class="overflow-auto">
            <table class="w-full text-sm">
              <thead class="text-left text-slate-500">
                <tr>
                  <th class="py-1">Time</th>
                  <th class="py-1">User</th>
                  <th class="py-1">v1</th>
                  <th class="py-1">v2</th>
                  <th class="py-1">Delta</th>
                  <th class="py-1">Diff?</th>
                </tr>
              </thead>
              <tbody id="shadowTable"></tbody>
            </table>
          </div>
        </section>
      </div>
    </div>

    <script src="/static/app.js"></script>
  </body>
</html>
